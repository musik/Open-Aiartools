# 登出功能测试指南

## 问题描述
之前点击logout后并没有真正退出，用户数据仍然可以通过API获取。

## 修复内容
1. **统一登出流程**：先调用API清除自定义JWT token，再清除NextAuth session
2. **完善cookie清理**：清除所有可能的认证相关cookies
3. **全局状态同步**：通过自定义事件通知所有组件清除用户状态
4. **强制刷新**：确保用户状态在登出后立即更新

## 测试步骤

### 1. 登录测试
- 使用有效凭据登录
- 确认用户信息正确显示
- 检查浏览器cookies中是否有认证相关cookie

### 2. 登出测试
- 点击logout按钮
- 确认以下行为：
  - 用户被重定向到首页
  - 用户状态被清除（不再显示用户信息）
  - 所有认证相关cookies被清除
  - 无法再访问需要认证的页面

### 3. 状态验证
- 登出后刷新页面
- 确认用户状态保持为未登录状态
- 尝试访问dashboard等受保护页面，应该被重定向到登录页

### 4. API测试
- 登出后调用`/api/auth/me`
- 应该返回401或用户未找到的错误

## 预期结果
- 登出后用户完全退出系统
- 所有认证状态被清除
- 用户需要重新登录才能访问受保护的功能
- 没有认证状态残留问题
